<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather API</title>
  </head>
  <body>
    <h2>current weather</h2>
    <select name="city" id="city-select" onchange="optionChange()">
      <option value="">지역 선택</option>
      <option value="Seoul">서울</option>
      <option value="Suwon">수원</option>
      <option value="Incheon">인천</option>
      <option value="Chuncheon">춘천</option>
      <option value="Cheongju-si">청주</option>
      <option value="Gangneung">강릉</option>
      <option>안동</option>
      <!--여기부터 value넣기.근데 안동이 중국도있네? 번호로 넣어야되나?번호도 똑같이 넣으면되는지 확인하기-->
      <option>전주</option>
      <option>대전</option>
      <option>대구</option>
      <option>울산</option>
      <option>포항</option>
      <option>목포</option>
      <option>광주</option>
      <option>여수</option>
      <option>창원</option>
      <option>부산</option>
      <option>제주</option>
    </select>

    <h3 class="time">현재 시간 :</h3>
    <h3 class="ctemp">현재 온도 :</h3>
    <h3 class="lowtemp">최저 온도 :</h3>
    <h3 class="hightemp">최고 온도 :</h3>
    <h3 class="icon"></h3>

    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    >
      //jquery 추가하는부분
    </script>
    <script>
      var city = "Incheon";
      // optionChange();
      // function optionChange() {
      //   var citySelect = document.getElementById("city-select");
      //   city =
      //     citySelect.options[
      //       document.getElementById("city-select").selectedIndex
      //     ].value;
      //   document.write(city);
      // }
      // document.write(city);
      $.getJSON(
        // 하단 링크에서 지역을 선택가능하게 바꾸기.
        "https://api.openweathermap.org/data/2.5/weather?q=" +
          city +
          "&appid=f09d75112c5bc3ebcdc2ceddcc684aa6&units=metric",
        function (result) {
          $(".ctemp").append(result.main.temp);
          $(".lowtemp").append(result.main.temp_min);
          $(".hightemp").append(result.main.temp_max);
          //아이콘 표시하기
          var wiconUrl =
            '<img src="http://openweathermap.org/img/wn/' +
            result.weather[0].icon +
            '.png" alt="' +
            result.weather[0].description +
            '">';
          $(".icon").html(wiconUrl);

          var ct = result.dt;
          function convertTime(t) {
            // 시간을 원하는 형식대로 반환하는 함수
            var ot = new Date(t * 1000); // 자릿수가 안맞아서 1000을 곱해줘야 제대로나옴=>구글링
            //ot == Sat Sep 04 2021 11:32:37 GMT+0900 (Korean Standard Time)
            var hr = ot.getHours();
            var m = ot.getMinutes();
            var s = ot.getSeconds();

            return hr + "시 " + m + "분 " + s + "초";
          }

          var currentTime = convertTime(ct);
          $(".time").append(currentTime);
        }
      );
    </script>
  </body>
</html>
